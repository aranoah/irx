<!DOCTYPE html>
<html>
  <head>
    <head>
    <% include ../partials/head.html.ejs %>

    <!--   Css files -->
    <link rel="stylesheet" type="text/css" href="/css/irxmisc/forgot.css">
    <style type="text/css">
    
    </style>
  </head>
  <body>
    <% locals.uiContext.menu=false %>
    <% include ../partials/header.html.ejs %>
    <script type="text/javascript">
    var fp = null;
    </script>
    <div class="irx-misc ui very relaxed stackable page grid" id="_fPassword_" style="padding-top:10rem;">
       <div class="ui centered page grid">
 
          <div class="ui card">
            <div class="content">
              <div class="lock"><i class="lock icon"></i></div>
              <h3 class="ui header">Forgot password ?</h3>
              <div class="description">
                <p>Enter you email address in the form below and we will send<br>you further instructions on how to reset your password.</p>
              </div>
                <div class="ui input focus">
                  <input type="text" data-bind="value:userId" name="userId" placeholder="Email address">
                  <div style="display:none" id="_msg">Please enter valid email address.</div>
                </div>
                <br>
                <div class="ui buttons">
               
                  <div class="ui submitAction cancel _csn" tabindex="0" style="cursor:pointer" onclick="javascript:location.href='/'">Cancel</div>
                   <div class="ui submitAction _csn" style="background:green;color:#fff;cursor:pointer" data-bind="click:function(){sendMail()}">Submit</div>
                </div>
            </div>
          </div>
      
      </div>
    </div>
    <% include ../partials/footer.html.ejs %>
  </body>
  <script>
  function ForgetPassword(){

  }

  ForgetPassword.prototype.init = function() {
    var _classInstance = this;
    _classInstance.viewModel = {
      userId: ko.observable(),
      sendMail : function(){
         var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
       
       if(!re.test(_classInstance.viewModel.userId())){
        $('#_msg').addClass('_ajActive');
        $('#_msg').addClass('_ajError');
        return ;
       }
       
       httpUtils.get("/forget-password/"+_classInstance.viewModel.userId(),
            {}
            ,"JSON"
            ,function(data){
             if(httpUtils.checkStatus(data,false)){
              $('#_msg').text(data.message);
              $('#_msg').addClass('_ajActive');
              $('#_msg').removeClass('_ajError');
              $('#_msg').addClass('_ajSuccess');
              $('.ui.buttons').hide();
             }else{
              $('#_msg').text(data.message);
              $('#_msg').addClass('_ajActive');
              $('#_msg').removeClass('_ajSuccess');
              $('#_msg').addClass('_ajError');
             }
          })
       
      }
    }
    ko.applyBindings(_classInstance.viewModel,document.getElementById('_fPassword_'))
  };
  $(document).ready(function(){
    fp = new ForgetPassword();
    fp.init();
  })
  </script>

</html>